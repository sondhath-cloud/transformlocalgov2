<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Services - TransformLocalGov</title>
    <meta name="description" content="Order strategic planning, teambuilding, training, and digital adoption services from TransformLocalGov">
    <link rel="icon" type="image/png" href="assets/images/TLGLogo.png">
    <link rel="stylesheet" href="styles.css">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css'>
    <!-- Stripe JavaScript SDK -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <style>
        .order-page {
            padding: 2rem;
            background: #f8f9fa;
            min-height: 100vh;
        }
        
        .order-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .order-header {
            text-align: center;
            margin-bottom: 3rem;
            margin-top: 4rem;
        }
        
        .order-title {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-orange);
            margin-bottom: 1rem;
        }
        
        .order-subtitle {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .accordion-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        .accordion-header {
            background: var(--primary-orange);
            color: white;
            padding: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
            border: none;
            width: 100%;
            text-align: left;
        }
        
        .accordion-header:hover {
            background: var(--dark-orange);
        }
        
        .accordion-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .accordion-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .accordion-header.active .accordion-icon {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
        }
        
        .accordion-content.active {
            max-height: 2000px;
        }
        
        .service-items {
            padding: 0;
        }
        
        .service-item {
            display: flex;
            align-items: flex-start;
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            transition: background 0.3s ease;
        }
        
        .service-item:hover {
            background: #f8f9fa;
        }
        
        .service-item:last-child {
            border-bottom: none;
        }
        
        .service-checkbox {
            margin-right: 1rem;
            margin-top: 0.25rem;
            transform: scale(1.2);
            accent-color: var(--primary-orange);
        }
        
        .service-content {
            flex: 1;
        }
        
        .service-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .service-description {
            color: #666;
            line-height: 1.5;
            margin-bottom: 0;
        }
        
        .service-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-orange);
            min-width: 100px;
            text-align: right;
        }
        
        .order-summary {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-top: 2rem;
            position: sticky;
            top: 2rem;
        }
        
        .summary-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .selected-items {
            margin-bottom: 1.5rem;
        }
        
        .selected-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .selected-item:last-child {
            border-bottom: none;
        }
        
        .item-name {
            font-weight: 500;
            color: #333;
        }
        
        .item-price {
            color: var(--primary-orange);
            font-weight: 600;
        }
        
        .total-section {
            border-top: 2px solid var(--primary-orange);
            padding-top: 1rem;
            margin-top: 1rem;
        }
        
        .total-line {
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
        }
        
        .order-buttons {
            display: flex;
            gap: 1rem;
            flex-direction: column;
        }
        
        .btn-consultation {
            background: var(--primary-orange);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: block;
        }
        
        .btn-consultation:hover {
            background: var(--dark-orange);
            transform: translateY(-2px);
        }
        
        .btn-purchase {
            background: #28a745;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: block;
        }
        
        .btn-purchase:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .btn-purchase:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .no-items-selected {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 2rem;
        }
        
        @media (max-width: 768px) {
            .order-page {
                padding: 1rem;
            }
            
            .order-title {
                font-size: 2rem;
            }
            
            .service-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .service-price {
                margin-top: 1rem;
                text-align: left;
            }
            
            .order-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 12px;">
                    <img src="assets/images/TLGLogo.png" alt="TransformLocalGov Logo" style="height: 40px; width: auto;">
                    <span class="logo-text">TransformLocalGov</span>
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="facilitation.html" class="nav-link">Facilitation</a>
                </li>
                <li class="nav-item">
                    <a href="digital-adoption.html" class="nav-link">Digital Adopt</a>
                </li>
                <li class="nav-item">
                    <a href="custom-tools.html" class="nav-link">Web/Apps</a>
                </li>
                <li class="nav-item">
                    <a href="order.html" class="nav-link active">Order</a>
                </li>
                <li class="nav-item">
                    <a href="resources.html" class="nav-link">Resources</a>
                </li>
                <li class="nav-item">
                    <a href="about.html" class="nav-link">About</a>
                </li>
                <li class="nav-item">
                    <a href="contact.html" class="nav-link">Contact</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Order Page -->
    <div class="order-page">
        <div class="order-container">
            <div class="order-header">
                <h1 class="order-title">Order Services</h1>
                <p class="order-subtitle">Select the services you need and we'll help you transform your organization. Choose to schedule a consultation or purchase directly.</p>
            </div>

            <form id="order-form">
                <!-- Strategic Planning Accordion -->
                <div class="accordion-container">
                    <button type="button" class="accordion-header" data-accordion="strategic-planning">
                        <h2>Strategic Planning</h2>
                    </button>
                    <div class="accordion-content" id="strategic-planning">
                        <div class="service-items">
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="strategic_planning_basic" data-price="2500" data-name="Strategic Planning Basic">
                                <div class="service-content">
                                    <div class="service-name">Strategic Planning Basic</div>
                                    <div class="service-description">Comprehensive strategic planning session including vision, mission, goals, and action plans for your organization.</div>
                                </div>
                                <div class="service-price">$2,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="strategic_planning_advanced" data-price="5000" data-name="Strategic Planning Advanced">
                                <div class="service-content">
                                    <div class="service-name">Strategic Planning Advanced</div>
                                    <div class="service-description">Extended strategic planning with stakeholder analysis, competitive assessment, and detailed implementation roadmap.</div>
                                </div>
                                <div class="service-price">$5,000</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="vision_mission_workshop" data-price="1500" data-name="Vision and Mission Workshop">
                                <div class="service-content">
                                    <div class="service-name">Vision and Mission Workshop</div>
                                    <div class="service-description">Focused workshop to develop and refine your organization's vision and mission statements.</div>
                                </div>
                                <div class="service-price">$1,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="goal_setting_session" data-price="1200" data-name="Goal Setting Session">
                                <div class="service-content">
                                    <div class="service-name">Goal Setting Session</div>
                                    <div class="service-description">Interactive session to establish SMART goals and key performance indicators for your team.</div>
                                </div>
                                <div class="service-price">$1,200</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Teambuilding & Retreat Accordion -->
                <div class="accordion-container">
                    <button type="button" class="accordion-header" data-accordion="teambuilding">
                        <h2>Teambuilding and Retreat</h2>
                    </button>
                    <div class="accordion-content" id="teambuilding">
                        <div class="service-items">
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="team_retreat_half_day" data-price="2000" data-name="Team Retreat - Half Day">
                                <div class="service-content">
                                    <div class="service-name">Team Retreat - Half Day</div>
                                    <div class="service-description">Half-day team building retreat with activities focused on communication, collaboration, and team dynamics.</div>
                                </div>
                                <div class="service-price">$2,000</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="team_retreat_full_day" data-price="3500" data-name="Team Retreat - Full Day">
                                <div class="service-content">
                                    <div class="service-name">Team Retreat - Full Day</div>
                                    <div class="service-description">Full-day intensive team building retreat with comprehensive activities and team development exercises.</div>
                                </div>
                                <div class="service-price">$3,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="leadership_team_building" data-price="4500" data-name="Leadership Team Building">
                                <div class="service-content">
                                    <div class="service-name">Leadership Team Building</div>
                                    <div class="service-description">Specialized retreat for leadership teams focusing on strategic alignment and executive collaboration.</div>
                                </div>
                                <div class="service-price">$4,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="conflict_resolution_workshop" data-price="1800" data-name="Conflict Resolution Workshop">
                                <div class="service-content">
                                    <div class="service-name">Conflict Resolution Workshop</div>
                                    <div class="service-description">Workshop focused on resolving team conflicts and building stronger working relationships.</div>
                                </div>
                                <div class="service-price">$1,800</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Instructor-Led Training Accordion -->
                <div class="accordion-container">
                    <button type="button" class="accordion-header" data-accordion="training">
                        <h2>Instructor-Led Training</h2>
                    </button>
                    <div class="accordion-content" id="training">
                        <div class="service-items">
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="leadership_development_training" data-price="3000" data-name="Leadership Development Training">
                                <div class="service-content">
                                    <div class="service-name">Leadership Development Training</div>
                                    <div class="service-description">Comprehensive leadership training program covering essential management and leadership skills.</div>
                                </div>
                                <div class="service-price">$3,000</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="communication_skills_training" data-price="2200" data-name="Communication Skills Training">
                                <div class="service-content">
                                    <div class="service-name">Communication Skills Training</div>
                                    <div class="service-description">Training program focused on improving verbal, written, and non-verbal communication skills.</div>
                                </div>
                                <div class="service-price">$2,200</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="change_management_training" data-price="2800" data-name="Change Management Training">
                                <div class="service-content">
                                    <div class="service-name">Change Management Training</div>
                                    <div class="service-description">Training on managing organizational change, including strategies for successful implementation.</div>
                                </div>
                                <div class="service-price">$2,800</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="project_management_training" data-price="2500" data-name="Project Management Training">
                                <div class="service-content">
                                    <div class="service-name">Project Management Training</div>
                                    <div class="service-description">Comprehensive project management training covering planning, execution, and monitoring techniques.</div>
                                </div>
                                <div class="service-price">$2,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="customer_service_training" data-price="1800" data-name="Customer Service Training">
                                <div class="service-content">
                                    <div class="service-name">Customer Service Training</div>
                                    <div class="service-description">Training program focused on delivering excellent customer service and building customer relationships.</div>
                                </div>
                                <div class="service-price">$1,800</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Digital Adoption Accordion -->
                <div class="accordion-container">
                    <button type="button" class="accordion-header" data-accordion="digital-adoption">
                        <h2>Digital Adoption</h2>
                    </button>
                    <div class="accordion-content" id="digital-adoption">
                        <div class="service-items">
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="digital_readiness_assessment" data-price="1500" data-name="Digital Readiness Assessment">
                                <div class="service-content">
                                    <div class="service-name">Digital Readiness Assessment</div>
                                    <div class="service-description">Comprehensive assessment of your organization's readiness for digital transformation and technology adoption.</div>
                                </div>
                                <div class="service-price">$1,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="software_implementation_support" data-price="4000" data-name="Software Implementation Support">
                                <div class="service-content">
                                    <div class="service-name">Software Implementation Support</div>
                                    <div class="service-description">End-to-end support for software implementation including planning, training, and change management.</div>
                                </div>
                                <div class="service-price">$4,000</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="user_training_program" data-price="2500" data-name="User Training Program">
                                <div class="service-content">
                                    <div class="service-name">User Training Program</div>
                                    <div class="service-description">Comprehensive training program for end users on new software systems and digital tools.</div>
                                </div>
                                <div class="service-price">$2,500</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="change_management_digital" data-price="3200" data-name="Digital Change Management">
                                <div class="service-content">
                                    <div class="service-name">Digital Change Management</div>
                                    <div class="service-description">Specialized change management support for digital transformation initiatives and technology adoption.</div>
                                </div>
                                <div class="service-price">$3,200</div>
                            </div>
                            <div class="service-item">
                                <input type="checkbox" class="service-checkbox" name="service[]" value="digital_workflow_optimization" data-price="2800" data-name="Digital Workflow Optimization">
                                <div class="service-content">
                                    <div class="service-name">Digital Workflow Optimization</div>
                                    <div class="service-description">Analysis and optimization of digital workflows to improve efficiency and productivity.</div>
                                </div>
                                <div class="service-price">$2,800</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <h3 class="summary-title">Order Summary</h3>
                    <div id="selected-items-container">
                        <div class="no-items-selected">Select services above to see your order summary</div>
                    </div>
                    <div class="total-section">
                        <div class="total-line">
                            <span>Total:</span>
                            <span id="total-price">$0</span>
                        </div>
                    </div>
                    <div class="order-buttons">
                        <button type="submit" class="btn-consultation" id="consultation-btn">
                            Submit to TransformLocalGov to Schedule Consultation
                        </button>
                        <button type="button" class="btn-purchase" id="purchase-btn" disabled>
                            Purchase Now
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initialize Stripe
        const stripe = Stripe('pk_test_51SJGdaFJO3XvllUNDSCA78E58XSfo9pcaZQaqw6VYT0Ae83BWhFB2FC6FpPPRFs0sVF7gpfePzgkzdhSla21QcG800BAN6cfwH');

        // Accordion functionality
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', function() {
                const target = this.getAttribute('data-accordion');
                const content = document.getElementById(target);
                const icon = this.querySelector('.accordion-icon');
                
                // Toggle active class
                this.classList.toggle('active');
                content.classList.toggle('active');
                
                // Rotate icon
                if (this.classList.contains('active')) {
                    icon.style.transform = 'rotate(180deg)';
                } else {
                    icon.style.transform = 'rotate(0deg)';
                }
            });
        });

        // Service selection and pricing
        let selectedServices = [];
        let totalPrice = 0;

        function updateOrderSummary() {
            const container = document.getElementById('selected-items-container');
            const totalElement = document.getElementById('total-price');
            const purchaseBtn = document.getElementById('purchase-btn');
            const consultationBtn = document.getElementById('consultation-btn');
            
            if (selectedServices.length === 0) {
                container.innerHTML = '<div class="no-items-selected">Select services above to see your order summary</div>';
                totalElement.textContent = '$0';
                purchaseBtn.disabled = true;
                consultationBtn.disabled = true;
                return;
            }
            
            // Build selected items HTML
            let itemsHTML = '<div class="selected-items">';
            selectedServices.forEach(service => {
                itemsHTML += `
                    <div class="selected-item">
                        <span class="item-name">${service.name}</span>
                        <span class="item-price">$${service.price.toLocaleString()}</span>
                    </div>
                `;
            });
            itemsHTML += '</div>';
            
            container.innerHTML = itemsHTML;
            totalElement.textContent = `$${totalPrice.toLocaleString()}`;
            purchaseBtn.disabled = false;
            consultationBtn.disabled = false;
        }

        // Handle checkbox changes
        document.querySelectorAll('.service-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const serviceId = this.value;
                const serviceName = this.getAttribute('data-name');
                const servicePrice = parseInt(this.getAttribute('data-price'));
                
                if (this.checked) {
                    selectedServices.push({
                        id: serviceId,
                        name: serviceName,
                        price: servicePrice
                    });
                    totalPrice += servicePrice;
                } else {
                    selectedServices = selectedServices.filter(service => service.id !== serviceId);
                    totalPrice -= servicePrice;
                }
                
                updateOrderSummary();
            });
        });

        // Form submission for consultation
        document.getElementById('consultation-btn').addEventListener('click', function(e) {
            e.preventDefault();
            
            if (selectedServices.length === 0) {
                alert('Please select at least one service before submitting.');
                return;
            }
            
            // Collect form data
            const formData = new FormData();
            formData.append('action', 'consultation');
            formData.append('services', JSON.stringify(selectedServices));
            formData.append('total_price', totalPrice);
            
            // Show loading state
            this.innerHTML = 'Submitting...';
            this.disabled = true;
            
            // Submit to PHP handler
            fetch('api/order-handler.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Thank you! Your consultation request has been submitted. We will contact you within 24 hours to schedule your services.');
                    // Reset form
                    document.getElementById('order-form').reset();
                    selectedServices = [];
                    totalPrice = 0;
                    updateOrderSummary();
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Sorry, there was an error submitting your request. Please try again.');
            })
            .finally(() => {
                this.innerHTML = 'Submit to TransformLocalGov to Schedule Consultation';
                this.disabled = false;
            });
        });

        // Purchase button for Stripe checkout
        document.getElementById('purchase-btn').addEventListener('click', function(e) {
            e.preventDefault();
            
            if (selectedServices.length === 0) {
                alert('Please select at least one service before purchasing.');
                return;
            }
            
            // Show loading state
            this.innerHTML = 'Processing...';
            this.disabled = true;
            
            // Create checkout session
            fetch('api/create-order-checkout.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    services: selectedServices,
                    total_price: totalPrice
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Redirect to Stripe checkout
                    stripe.redirectToCheckout({
                        sessionId: data.session_id
                    });
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Sorry, there was an error processing your purchase. Please try again.');
            })
            .finally(() => {
                this.innerHTML = 'Purchase Now';
                this.disabled = false;
            });
        });

        // Mobile menu toggle
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');

        hamburger.addEventListener('click', function() {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close mobile menu when clicking on a link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            });
        });
    </script>
</body>

</html>
